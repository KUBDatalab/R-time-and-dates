---
title: "Introduction to time"
teaching: 42
exercises: 47
questions: 
- "What is time?"
- "Various issues when working with time"
objectives:
- "Understand how time is defined in the context of R"
- "Understand how complicated this actually is"
keypoints:
- "People assume that time is a strict progression of cause to effect, but *actually* from a non-linear, non-subjective viewpoint - it's more like a big ball of wibbly wobbly... time-y wimey... stuff."
source: Rmd
---

doktoren 

Link til Tom 
https://www.youtube.com/watch?v=-5wpm-gesOY

En 10 minutter lang rant om hvorfor man som programmør aldrig ALDRIG bør arbejde 
med tidszoner.

Vi starter med at se hvor mange sekunder der er gået fra et bestemt tidspunkt.
Men nu vil vi ændre tidszoner. Så hvad er forskellen på NU i London og for 
fem dage siden i New York. det er en forskel på X timer.

Så er der australien. De er 9½ time foran London.

Nepal... De er 5 1/4 foran london.

Så kigger vi på listen over tidszoner.

så bliver det efterår. Og vi går fra sommertid til vintertid.

Men England skifter en uge før os andre...

Så vi kigger på listen over hvornår forskellige lande skifter sommertid.

Så er der lige den detalje, at på den sydlige del af halvkuglen. Der sætter 
de havemøblerne frem i hvad der er efterår på den nordlige halvdel.
Så... (er det ikke meget eurocentrisk at vi lader den nordlige halvdel 
sætte standarden? Måske. men 67.3% af jordens landmasse ligger nord for 
ækvator. og 87% af befolkningen bor nord for ækvator. Jamen hvad med Afrika?
er det ikke ondt at vi lader den nordlige halvkugle definere det?
Måske. ca. 2/3 af afrika ligger nord for ækvator. Så det.)


Samoa. I 2011 sprang de en dag over. De gik fra 29. december til 31. december.
Fordi de hoppede fra den ene side af datolinien til den anden (eller rettere
datolinien blev flyttet)
Så vi napper også listen over hvornår et land skifter tidszone.

Under anden verdenskrig havde UK dobbel sommertid. 

Listen over hvornår lande skifter tidszoner. Find den.

Vestbredden... Den israelske befolkning lever efter israelsk tidszone. og palæstinenserne 
efter en anden (for guderne forbyde at...)

Og så var der historikerne.

Skiftet fra den julianske til den gregorianske kalender. hvor vi hopper ca tre uger.

Den russiske historiker. Der skifter kalenderen i 1918.,..

og den engelske historiker. Der fortæller at indtil 1600 tallet - der startede året
den 24 marts. 

Skudsekunder... Der undertiden er negative...

23.59.58
23.59.59
23.59.60
00.00.00

Så 61 sekunder i et minut...

Unix timestamp. 

UTC er løsningen, der inkluderer skudsekunder.

Altså bortset fra astonomisk tid. Der ikke inkluderer skudsekunder.


https://www.iana.org/time-zones

```{r}
library(lubridate)
test <- lubridate::as_datetime("1918-01-01 11:00:00")
test2 <- with_tz(test, tzone="Europe/Moscow")
test2 + 34*60*60*24

library(tidyverse)


tmp <- as.POSIXlt("16Jun10", format = "%d%b%y")
tmp$yday

OlsonNames() %>% enframe() %>% filter(str_detect(value, "Mos"))
```

men vi kommer kun til at kigge på normale datoer her.

Den anden pakke vi skal kigge på er library(tsibble)

Eller - det skal vi nok ikke. Vi skal snarere kigge på
zoo::yearmon og zoo::yearqtr

Det lader til at lubridate ikke tager højde for skudsekunder.

Udgangspunktet for tid i R er POSIX time. Antallet af 
sekunder efter 1970-01-01T00:00:00z.
Z'et angiver at vi taler om UTC, universal coordinated
time. Det klokken ER. Definitorisk!

tidspunkter før tælles som negative værdier.

Det er her vi bliver bekymret for hvad der sker når 
antallet af sekunder bliver for stort. Det fixer vi.

Det samme med datoer - antal dage før eller efter 
1970-01-01.

posixct. Kalendertid. antal sekunder siden sammen med
en tidszone.
posixlt. Lokal tid. Der er vist også en weekdag.

unclass() er værd at kigge på.

I R arbejder vi med fire forskellige tidsfænomener.
Et punkt i tid (og til en vis grad i rum). et tidspunkt.

En duration. En uge. En måned. En time. Vi kan skabe en duration med
lubridate::dxxxx hvor xxxx er den vi vil lave. Fra nanosekunder til uger. Vi holder fingrene fra måneder og år, for de har ikke en fast længde, og vi vil få returneret den gennemsnitlige længde: En gang imellem er ne måned 
```{r}
lubridate::dyears()
31557600/60/60/24
```
Derfor har vi også perioder. En tidsforskel der matcher
den gregorianske kalender. Så hvis vi lægger en måned til
1. februar, får vi 1. marts. Og hvis vi lægger en måned til
1. marts, får vi 1. april. 

Interval. 
Hvad er sammenhængen mellem interval og duration?
Et interval er den tid, det antal sekunder, der er mellem to specifikke tidspunkter.
https://www.jstatsoft.org/article/view/v040i03

Konklusionen indtil videre er vist at jeg stadig er usikker på de tre koncepter...

{% include links.md %}